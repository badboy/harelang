image: darwin/20.6.0
sources:
- https://git.sr.ht/~sircmpwn/hare
- https://git.sr.ht/~sircmpwn/harec
- git://c9x.me/qbe.git
packages:
- binutils
- scdoc
tasks:
- qbe: |
    cd qbe
    make -j2 PREFIX=/usr
    sudo make install PREFIX=/usr
- harec: |
    mkdir harec/build
    cd harec/build
    ../configure --prefix=/usr
    make -j2
    sudo make install
- hare: |
    cd hare
    sed -e 's/freebsd/darwin/g' < config.example.mk > config.mk
    make -j2
    sudo make install
- tests: |
    cd hare
    make -j2 .bin/hare-tests
- check: |
    cd hare
    make -j2 check
